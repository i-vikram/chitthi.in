<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chitthi.in - Modern Love Letters with Traditional Soul</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cedarville+Cursive&family=Playfair+Display:wght@400;700&display=swap');
        
        .vintage-text { font-family: 'Playfair Display', serif; }
        .handwriting { font-family: 'Cedarville Cursive', cursive; }

        .parchment-bg {
            background-image: url('data:image/svg+xml,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.7" numOctaves="3"/></filter><rect width="100%" height="100%" filter="url(%23n)" opacity="0.2"/></svg>'),
            linear-gradient(to bottom right, #faf3e0 0%, #f3e5c5 100%);
        }

        @keyframes fold {
            0% { transform: scale(1); opacity: 1; height: 600px; }
            100% { transform: scale(0.3); opacity: 0; height: 0; }
        }

        .fold-animation {
            animation: fold 1s ease-in-out forwards;
            transform-origin: center;
        }

        .petal {
            animation: drift 8s linear infinite;
            opacity: 0.7;
        }

        @keyframes drift {
            0% { transform: translateY(-10vh) rotate(0deg); }
            100% { transform: translateY(110vh) rotate(360deg); }
        }

        .decorative-text {
            position: absolute;
            opacity: 0.15;
            font-weight: 900;
            pointer-events: none;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            z-index: 0;
        }
    </style>
</head>
<body class="bg-stone-100">
    <!-- Hero Section -->
    <section class="min-h-screen relative overflow-hidden">
        <div class="absolute inset-0 parchment-bg opacity-90"></div>
        
        <!-- Rose Petals -->
        <div class="petal absolute top-0 left-1/4 w-16 h-16" style="animation-delay: 0s">
            <svg viewBox="0 0 100 100" class="text-rose-300/70">
                <path fill="currentColor" d="M50 10 Q60 30 70 40 Q80 50 70 60 Q60 70 50 80 Q40 70 30 60 Q20 50 30 40 Q40 30 50 10" />
            </svg>
        </div>
        <div class="petal absolute top-0 right-1/4 w-16 h-16" style="animation-delay: 2s">
            <svg viewBox="0 0 100 100" class="text-rose-300/70">
                <path fill="currentColor" d="M50 10 Q60 30 70 40 Q80 50 70 60 Q60 70 50 80 Q40 70 30 60 Q20 50 30 40 Q40 30 50 10" />
            </svg>
        </div>

        <!-- Decorative Elements -->
        <div id="decorativeElements"></div>

        <div class="relative z-10 container mx-auto px-4 py-20">
            <div class="max-w-4xl mx-auto text-center">
                <h1 class="vintage-text text-5xl md:text-6xl font-bold text-rose-800 mb-4">
                    Chitthi.in
                </h1>
                <p class="handwriting text-3xl text-rose-600 mb-6">
                    Ditch Boring Texts. Send a Chitthi That Feels Special!
                </p>
                <p class="handwriting text-2xl text-amber-900 mb-8">
                    Where Vintage Charm Meets Digital Heartbeats
                </p>
                <img src="./icons8-letter-58.png" 
                class="wax-seal w-24 h-24 mx-auto mb-8 opacity-90">

                <button onclick="scrollToEditor()" 
                        class="bg-rose-800 hover:bg-rose-900 text-white px-8 py-4 rounded-full 
                               transform transition-all duration-300 hover:scale-105 vintage-text">
                    Begin Your Love Letter
                </button>
            </div>
        </div>
    </section>

    <!-- Letter Editor Section -->
    <section id="editor" class="py-20 px-4 hidden">
        <div class="max-w-3xl mx-auto shadow-2xl rounded-lg overflow-hidden parchment-bg relative transition-all duration-500" style="min-height: 600px">
            <div id="letterContainer" class="p-8 relative h-full">
                <div class="flex justify-between items-center mb-8">
                    <h2 class="vintage-text text-3xl text-rose-800">My Heartfelt Chitthi</h2>
                    <input type="file" id="imageUpload" accept="image/*" 
                           class="hidden" onchange="handleImageUpload(event)" multiple>
                    <label for="imageUpload" 
                           class="cursor-pointer bg-rose-700 text-white px-4 py-2 
                                  rounded-lg hover:bg-rose-800 transition-colors">
                        Add Memory
                    </label>
                </div>
                <textarea id="letterContent" 
                          class="w-full h-[500px] bg-transparent border-none focus:ring-0 
                                 handwriting text-xl text-amber-900 resize-none"
                          placeholder="Dearest..."></textarea>
                <div id="imagePreview" class="mt-6 grid grid-cols-2 md:grid-cols-3 gap-6 p-4"></div>
            </div>

            <div class="border-t-2 border-rose-100 p-4 bg-rose-50" id="sealButton">
                <button onclick="saveLetter()" 
                        class="bg-rose-800 text-white px-6 py-3 rounded-lg 
                               hover:bg-rose-900 transition-colors vintage-text">
                    Seal with Love
                </button>
            </div>
        </div>
    </section>

    <!-- Download Section -->
    <section id="downloadSection" class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center">
        <div class="bg-white rounded-lg p-8 max-w-md text-center relative">
            <button onclick="closeDownloadSection()" 
                    class="absolute top-2 right-2 text-rose-800 hover:text-rose-900 text-xl">
                ✕
            </button>
            <h3 class="vintage-text text-2xl text-rose-800 mb-4">Your Chitthi is Ready!</h3>
            <div class="flex justify-center gap-4">
                <button onclick="downloadLetter()" 
                        class="bg-rose-800 text-white px-6 py-3 rounded-lg hover:bg-rose-900 transition-colors">
                    Download
                </button>
                <button onclick="shareLetter()" 
                        class="bg-emerald-600 text-white px-6 py-3 rounded-lg hover:bg-emerald-700 transition-colors">
                    Share
                </button>
            </div>
        </div>
    </section>

    <script>
        let capturedCanvas = null;

        function addDecorativeElements() {
            const container = document.getElementById('decorativeElements');
            const positions = [
                { top: '15%', left: '5%', size: '6rem', text: 'LOVE', color: '#be185d' },
                { top: '40%', left: '70%', size: '8rem', text: '❤', color: '#fb7185' },
                { top: '65%', left: '20%', size: '7rem', text: 'LOVE', color: '#be185d' },
                { top: '80%', left: '60%', size: '9rem', text: '❤', color: '#fb7185' }
            ];

            positions.forEach(pos => {
                const elem = document.createElement('div');
                elem.className = 'decorative-text';
                elem.style.top = pos.top;
                elem.style.left = pos.left;
                elem.style.fontSize = pos.size;
                elem.style.color = pos.color;
                elem.style.opacity = pos.text === '❤' ? '0.2' : '0.15';
                elem.style.rotate = `${Math.random() * 30 - 15}deg`;
                elem.textContent = pos.text;
                elem.style.fontFamily = pos.text === '❤' ? 'system-ui' : "'Cedarville Cursive', cursive";
                container.appendChild(elem);
            });
        }

        function scrollToEditor() {
            document.getElementById('editor').classList.remove('hidden');
            window.scrollTo({
                top: document.getElementById('editor').offsetTop - 50,
                behavior: 'smooth'
            });
        }

        function handleImageUpload(event) {
            const files = event.target.files;
            const preview = document.getElementById('imagePreview');
            
            for (const file of files) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const card = document.createElement('div');
                    card.className = 'photo-card relative group';
                    card.innerHTML = `
                        <div class="relative p-2">
                            <img src="${e.target.result}" 
                                 class="w-full h-48 object-cover rounded-lg shadow-lg border-2 border-white">
                            <button onclick="this.parentElement.parentElement.remove()" 
                                    class="absolute top-0 right-0 bg-rose-700 text-white 
                                           rounded-full w-6 h-6 flex items-center justify-center 
                                           hover:bg-rose-800 transition-colors transform -translate-y-1/2 translate-x-1/2">
                                ×
                            </button>
                        </div>
                    `;
                    preview.appendChild(card);
                }
                reader.readAsDataURL(file);
            }
        }

        function saveLetter() {
            const content = document.getElementById('letterContent').value;
            if(content.trim()) {
                const editor = document.querySelector('#editor > div');
                editor.classList.add('fold-animation');

                // Create a clone for capturing
                const clone = document.getElementById('letterContainer').cloneNode(true);
                clone.style.width = '800px';
                clone.style.minHeight = '600px';
                
                // Replace textarea with div
                const textDiv = document.createElement('div');
                textDiv.className = 'handwriting text-xl text-amber-900 whitespace-pre-wrap px-4';
                textDiv.textContent = content; //preserve line breaks
                clone.querySelector('textarea').replaceWith(textDiv);
                
                // Remove UI elements
                clone.querySelectorAll('button, label, h2').forEach(el => el.remove());
                
                // Add footer
                const footer = document.createElement('div');
                footer.className = 'absolute bottom-4 left-0 right-0 text-center text-rose-700 vintage-text text-lg';
                footer.innerHTML = `Crafted with ♥ at chitthi.in`;
                clone.appendChild(footer);

                document.body.appendChild(clone);
                
                html2canvas(clone, {
                    backgroundColor: '#faf3e0',
                    scale: 2,
                    logging: true
                }).then(canvas => {
                    capturedCanvas = canvas;
                    document.body.removeChild(clone);
                    document.getElementById('downloadSection').classList.remove('hidden');
                });
            }
        }

        function downloadLetter() {
            if(capturedCanvas) {
                const link = document.createElement('a');
                link.download = 'my-chitthi.png';
                link.href = capturedCanvas.toDataURL();
                link.click();
            }
        }

        function shareLetter() {
            if (navigator.share && capturedCanvas) {
                capturedCanvas.toBlob(async (blob) => {
                    const file = new File([blob], 'chitthi.png', { type: 'image/png' });
                    try {
                        await navigator.share({
                            title: 'My Love Letter',
                            files: [file]
                        });
                    } catch(err) {
                        console.error('Error sharing:', err);
                    }
                });
            } else {
                alert('Sharing not supported - please download and share manually');
            }
        }

        function closeDownloadSection() {
            document.getElementById('downloadSection').classList.add('hidden');
        }

        // Initialize decorative elements
        window.onload = addDecorativeElements;
    </script>
</body>
</html>